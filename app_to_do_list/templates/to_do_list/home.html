{% load static %}

<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="{% static 'css/home.css' %}">
    
</head>
<body>

    <nav class="navbar navbar-dark bg-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">Offcanvas Navbar</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar"
                aria-controls="offcanvasNavbar">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasNavbar"
                aria-labelledby="offcanvasNavbarLabel">
                <div class="offcanvas-header">
                    <h5 class="offcanvas-title" id="offcanvasNavbarLabel">Offcanvas</h5>
                    <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas"
                        aria-label="Close"></button>
                </div>
                <div class="offcanvas-body bg-dark">
                    <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
                        <li class="nav-item">
                            <a class="nav-link active" aria-current="page" href="#">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">Link</a>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="offcanvasNavbarDropdown" role="button"
                                data-bs-toggle="dropdown" aria-expanded="false">
                                Dropdown
                            </a>
                            <ul class="dropdown-menu" aria-labelledby="offcanvasNavbarDropdown">
                                <li><a class="dropdown-item" href="#">Action</a></li>
                                <li><a class="dropdown-item" href="#">Another action</a></li>
                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                                <li><a class="dropdown-item" href="#">Something else here</a></li>
                            </ul>
                        </li>
                    </ul>
                    <form method="get" action="{% url 'home' %}" class="d-flex">
                        <input class="form-control me-2" type="text" name="termo_pesquisa"
                            value="{{request.GET.termo_pesquisa}}" placeholder="Pesquisar">
                        <button class="btn btn-outline-success" type="submit">Pesquisar</button>
                    </form>
                </div>
            </div>
        </div>
    </nav>

    <main class="container mt-5">
            <h1 id="Titulo" class="text-center">Minhas Tarefas</h1>

        <a href="{% url 'criar_tarefa' %}" class="btn btn-primary mt-4">
            <svg width="20" height="20" fill="currentColor" aria-hidden="true">
                <path
                    d="M10 5a1 1 0 0 1 1 1v3h3a1 1 0 1 1 0 2h-3v3a1 1 0 1 1-2 0v-3H6a1 1 0 1 1 0-2h3V6a1 1 0 0 1 1-1Z" />
            </svg>
            Nova Tarefa
        </a>
        
        <!-- ... Filtros ... -->
        <form method="get" action="/" class="mt-3">
            <div class="row g-3">
            <div class="col-md-4">
                <label for="id_categoria">Categoria:</label>
                <select id="id_categoria" name="categoria" class="form-select">
                    <option value="" {% if not categoria_selecionada %}selected{% endif %}>Todas as categorias</option>
                    <option value="pessoal" {% if categoria_selecionada == 'pessoal' %}selected{% endif %}>Pessoal</option>
                    <option value="estudos" {% if categoria_selecionada == 'estudos' %}selected{% endif %}>Estudos</option>
                    <option value="projetos" {% if categoria_selecionada == 'projetos' %}selected{% endif %}>Projetos</option>
                    <option value="lazer" {% if categoria_selecionada == 'lazer' %}selected{% endif %}>Lazer</option>
                    <option value="trabalho" {% if categoria_selecionada == 'trabalho' %}selected{% endif %}>Trabalho</option>
                    <option value="familia" {% if categoria_selecionada == 'familia' %}selected{% endif %}>Família</option>
                    <option value="saude" {% if categoria_selecionada == 'saude' %}selected{% endif %}>Saúde</option>
                    <option value="viagem" {% if categoria_selecionada == 'viagem' %}selected{% endif %}>Viagem</option>
                    <option value="social" {% if categoria_selecionada == 'social' %}selected{% endif %}>Social</option>
                    <option value="financas" {% if categoria_selecionada == 'financas' %}selected{% endif %}>Finanças</option>
                    <option value="compras" {% if categoria_selecionada == 'compras' %}selected{% endif %}>Compras</option>
                </select>
            </div>
        
            <div class="col-md-4">
                <label for="id_prioridade">Prioridade:</label>
                <select id="id_prioridade" name="prioridade" class="form-select">
                    <option value="" {% if not prioridade_selecionada %}selected{% endif %}>Todas as prioridades</option>
                    <option value="1" {% if prioridade_selecionada == '1' %}selected{% endif %}>⭐</option>
                    <option value="2" {% if prioridade_selecionada == '2' %}selected{% endif %}>⭐⭐</option>
                    <option value="3" {% if prioridade_selecionada == '3' %}selected{% endif %}>⭐⭐⭐</option>
                    <option value="4" {% if prioridade_selecionada == '4' %}selected{% endif %}>⭐⭐⭐⭐</option>
                    <option value="5" {% if prioridade_selecionada == '5' %}selected{% endif %}>⭐⭐⭐⭐⭐</option>
                </select>
            </div>
        
            <div class="col-md-4">
                <label for="id_status" class="mr-2 ml-4">Status:</label>
                <select id="id_status" name="status" class="form-select">
                    <option value="" {% if not status_selecionado %}selected{% endif %}>Todos</option>
                    <option value="a_fazer" {% if status_selecionado == 'a_fazer' %}selected{% endif %}>A fazer</option>
                    <option value="feitas" {% if status_selecionado == 'feitas' %}selected{% endif %}>Feitas</option>
                </select>
            </div>

            <div><input type="submit" value="Filtrar"></div>
        </form>

        <!-- ... Cards de cada tarefa ... -->
        
        <div class="container mt-5">
            <div class="row justify-content-center">
                {% for tarefa in page.object_list %}
                    <div class="col-md-6">
                        <div class="card mb-4">
                            <div>
                                {% if tarefa.prioridade == 1 %}
                                    <span class="estrela">★ </span>
                                {% elif tarefa.prioridade == 2 %}
                                    <span class="estrela">★★</span>
                                {% elif tarefa.prioridade == 3 %}
                                    <span class="estrela">★★★ </span>
                                {% elif tarefa.prioridade == 4 %}
                                    <span class="estrela">★★★★</span>
                                {% elif tarefa.prioridade == 5 %}
                                    <span class="estrela">★★★★★</span>
                                {% endif %}
                                <h1 class="tarefa">{{ tarefa.nome_tarefa }}</h1>
                                <p>Tarefa Concluida: 
                                {% if tarefa.concluida %}
                                    <span>sim</span>
                                {% else %}
                                    <span>não</span>
                                {% endif %}
                                </p>
                                <a href="{% url 'editar_tarefa' id_tarefa=tarefa.id %}" class="btn btn-vermais">editar</a>
                                <a href="{% url 'delete' id_tarefa=tarefa.id %}" class="btn btn-vermais">excluir</a>
                                <a href="{% url 'concluida' id_tarefa=tarefa.id %}" class="btn btn-vermais">concluida</a>
                                <a href="{% url 'delete' id_tarefa=tarefa.id %}" class="btn btn-vermais"></a>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
        

            <!-- ... Paginação ... -->
        {% if request.GET.termo_pesquisa %}
        {% if page.has_previous %}
        <a href="{% url 'home' %}?termo_pesquisa={{request.GET.termo_pesquisa}}&page={{page.previous_page_number}}"
            class="block text-center text-blue-500 mt-4">Anterior</a>
        {% endif %}

        {% if page.has_next %}
        <a href="{% url 'home' %}?termo_pesquisa={{request.GET.termo_pesquisa}}&page={{page.next_page_number}}"
            class="block text-center text-blue-500 mt-4">Próximo</a>
        {% endif %}
        {% endif %}

        {% if paginacao %}
        {% if page.has_previous %}
        <a href="{% url 'home' %}?page={{page.previous_page_number}}"
            class="block text-center text-blue-500 mt-4">Anterior</a>
        {% endif %}

        {% if page.has_next %}
        <a href="{% url 'home' %}?page={{page.next_page_number}}"
            class="block text-center text-blue-500 mt-4">Próximo</a>
        {% endif %}
        {% endif %}

        {% if paginacao_filtros %}
        {% if page.has_previous %}
        <a href="?categoria={{ categoria_selecionada }}&prioridade={{ prioridade_selecionada }}&status={{ status_selecionado }}&page={{ page.previous_page_number }}"
            class="block text-center text-blue-500 mt-4">Anterior</a>
        {% endif %}

        {% if page.has_next %}
        <a href="?categoria={{ categoria_selecionada }}&prioridade={{ prioridade_selecionada }}&status={{ status_selecionado }}&page={{ page.next_page_number }}"
            class="block text-center text-blue-500 mt-4">Próximo</a>
        {% endif %}
        {% endif %}
        
    </main>

    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{% static 'js/home.js' %}"></script>

</body>

</html>
